apiVersion: v1
kind: ConfigMap
metadata:
  name: sentinel-config
  namespace: default
data:
  # Controller endpoint for alerts
  controller_url: "http://controller:8080/api/alerts"
  
  # Namespace to watch
  namespace: "default"
  
  # Label selector for pods to watch
  watch_labels: "app=frontend-api"
  
  # SQLi detection patterns (regex)
  sqli_patterns: |
    (?i)(union\s+select|select\s+.*\s+from|insert\s+into|delete\s+from|drop\s+table)
    (?i)(or\s+1\s*=\s*1|'\s*or\s+'1'\s*=\s*'1)
    (?i)(exec\s*\(|execute\s+immediate)
    (?i)(\-\-|;--|\/\*|\*\/)
  
  # Path traversal pattern (regex)
  path_traversal_pattern: "(?i)(\\.\\.\\/|\\.\\.\\\\|%2e%2e%2f|%2e%2e\\/|\\.\\.%2f)"
  
  # Rate limit threshold (requests per minute)
  rate_limit_threshold: "50"
  
  # Rate limit window (duration)
  rate_limit_window: "1m"
  
  # Auth failure threshold
  auth_failure_limit: "3"
  
  # Auth failure window (duration)
  auth_failure_window: "1m"
  
  # Cooldown period between alerts for same IP (duration)
  cooldown_period: "5m"
  
  # Decoy URLs (comma-separated)
  decoy_urls: "http://decoy-frontend-1:8080,http://decoy-frontend-2:8080,http://decoy-frontend-3:8080" 
